<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Zoloz Quick Share (Test)</title>
  <style>
    body{font-family:system-ui,Segoe UI,Arial;line-height:1.4;padding:14px}
    input,textarea,button{width:100%;box-sizing:border-box;margin:6px 0;padding:8px}
    iframe{width:100%;height:420px;border:1px solid #ddd;margin-top:8px}
    pre{background:#f6f6f6;padding:8px;overflow:auto}
  </style>
</head>
<body>
  <h2>Zoloz Quick Share — تجريبي</h2>
  <p>اختار الزرار اللي يناسبك: iframe للتجربة، fetch للديبج، و new tab للتشغيل الفعلي.</p>

  <label>Request URL (معبّى من عندك):</label>
  <textarea id="url" rows="3">https://hk-production-cdn.zoloz.net/page/face-fe/index.html?... (حط لينكك هنا)</textarea>

  <button id="openIframe">Open iframe</button>
  <button id="doFetch">Send fetch request (may be blocked by CORS)</button>
  <button id="openDirect">Open in new tab (Direct, with camera)</button>

  <div id="messages"></div>

  <iframe id="targetFrame"
    sandbox="allow-forms allow-scripts allow-same-origin"
    allow="camera; microphone"></iframe>

  <h3>Debug / Response</h3>
  <pre id="output">Ready</pre>

  <script>
    const urlEl = document.getElementById('url');
    const out = document.getElementById('output');
    const msg = document.getElementById('messages');
    const frame = document.getElementById('targetFrame');

    // زرار iframe
    document.getElementById('openIframe').addEventListener('click', ()=>{
      const u = urlEl.value.trim();
      if(!u){alert('حط اللينك الأول');return}
      out.textContent = 'Opening iframe...';
      frame.src = u;
      msg.innerHTML = '<small>Opened in iframe — لو الصفحة اشتغلت يبقى حلو، لو طلب الكاميرا يبقى ممتاز. لو فاضي → السيرفر مانع.</small>';
    });

    // زرار fetch
    document.getElementById('doFetch').addEventListener('click', async ()=>{
      const u = urlEl.value.trim();
      if(!u){alert('حط اللينك الأول');return}
      out.textContent = 'Sending fetch... (this often fails because of CORS)';
      try{
        const r = await fetch(u, {method:'GET', mode:'cors', credentials:'include'});
        const txt = await r.text();
        out.textContent = `Status: ${r.status} \n--- RESPONSE START ---\n${txt.slice(0,2000)}\n--- RESPONSE END ---`;
      }catch(e){
        out.textContent = 'Fetch failed: '+e.message + '\n(عادي جدًا لو السيرفر قافل CORS).';
      }
    });

    // زرار direct open
    document.getElementById('openDirect').addEventListener('click', ()=>{
      const u = urlEl.value.trim();
      if(!u){alert('حط اللينك الأول');return}
      window.open(u, '_blank');
    });
  </script>
</body>
</html>
